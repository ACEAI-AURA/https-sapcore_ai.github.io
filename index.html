<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAPCORE - Sapphire AI Core Universe</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts (Noto Sans KR) -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@100;300;400;500;700;900&display=swap" rel="stylesheet">
    
    <!-- Import Map for React & Lucide -->
    <script type="importmap">
    {
        "imports": {
            "react": "https://esm.sh/react@18.2.0",
            "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
            "lucide-react": "https://esm.sh/lucide-react@0.344.0"
        }
    }
    </script>

    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <style>
        body { font-family: 'Noto Sans KR', sans-serif; }
        /* Hide scrollbar for Chrome, Safari and Opera */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        /* Hide scrollbar for IE, Edge and Firefox */
        .no-scrollbar { -ms-overflow-style: none;  scrollbar-width: none; }
    </style>
</head>
<body class="bg-[#F8F9FA]">
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import React, { useState, useEffect, useRef } from 'react';
        import { createRoot } from 'react-dom/client';
        import { 
            Compass, Layers, PlayCircle, BookOpen, UserCircle2, Flame, 
            MessageSquare, Gem, Plus, ArrowUpRight, TrendingUp, Star, 
            Heart, X, Send, Image as ImageIcon, Film, PenTool, LogOut, 
            Mail, Lock, User, Camera, UserPlus, UserCheck, Globe, 
            Scissors, Users, Search, Bell, Edit2, Check, Sparkles, Download 
        } from 'lucide-react';

        // --- Firebase Imports ---
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js';
        import { 
            getFirestore, collection, addDoc, getDocs, query, where 
        } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js';
        import { 
            getAuth, signInAnonymously, onAuthStateChanged, signInWithCustomToken 
        } from 'https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js';

        // --- Firebase Configuration & Initialization ---
        // ì£¼ì˜: ë¡œì»¬ íŒŒì¼ë¡œ ì‹¤í–‰ ì‹œ __firebase_configê°€ ì—†ì„ ìˆ˜ ìžˆìœ¼ë¯€ë¡œ ì˜ˆì™¸ ì²˜ë¦¬
        let app, auth, db;
        let appId = 'default-app-id';

        try {
            const firebaseConfig = typeof __firebase_config !== 'undefined' 
                ? JSON.parse(__firebase_config) 
                : { 
                    // ë¡œì»¬ ì‹¤í–‰ìš© ë”ë¯¸ ì„¤ì • (ì‹¤ì œ ì‚¬ìš©ì‹œ ë³¸ì¸ì˜ Firebase í‚¤ë¡œ êµì²´ í•„ìš”)
                    apiKey: "YOUR_API_KEY",
                    authDomain: "your-project.firebaseapp.com",
                    projectId: "your-project-id",
                    storageBucket: "your-project.appspot.com",
                    messagingSenderId: "00000000000",
                    appId: "1:00000000000:web:00000000000000" 
                  };
            
            // í‚¤ê°€ ì—†ëŠ” ê²½ìš° ì´ˆê¸°í™” ë°©ì§€
            if (firebaseConfig.apiKey !== "YOUR_API_KEY") {
                app = initializeApp(firebaseConfig);
                auth = getAuth(app);
                db = getFirestore(app);
                appId = typeof __app_id !== 'undefined' ? __app_id : 'sapcore-web-app';
            }
        } catch (e) {
            console.warn("Firebase initialization failed. Features requiring DB will utilize local state only.");
        }

        // --- Translation Data ---
        const TRANSLATIONS = {
            ko: {
                login: 'ë¡œê·¸ì¸', signup: 'íšŒì›ê°€ìž… ì™„ë£Œ', signupLink: 'íšŒì›ê°€ìž…í•˜ê¸°', loginLink: 'ë¡œê·¸ì¸í•˜ê¸°',
                noAccount: 'ì•„ì§ ê³„ì •ì´ ì—†ìœ¼ì‹ ê°€ìš”?', hasAccount: 'ì´ë¯¸ ê³„ì •ì´ ìžˆìœ¼ì‹ ê°€ìš”?',
                emailPlace: 'ì´ë©”ì¼ (E-mail)', pwPlace: 'ë¹„ë°€ë²ˆí˜¸ (Password)', nickPlace: 'ë‹‰ë„¤ìž„ (Nickname)',
                loginFail: 'ë¡œê·¸ì¸ ì‹¤íŒ¨: ì´ë©”ì¼ ë˜ëŠ” ë¹„ë°€ë²ˆí˜¸ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.', emailDup: 'ì´ë¯¸ ê°€ìž…ëœ ì´ë©”ì¼ìž…ë‹ˆë‹¤.',
                fillAll: 'ëª¨ë“  í•­ëª©ì„ ìž…ë ¥í•´ì£¼ì„¸ìš”.', welcome: 'í™˜ì˜í•©ë‹ˆë‹¤', explore: 'íƒìƒ‰', nodes: 'ë…¸ë“œ',
                stories: 'ìŠ¤í† ë¦¬', profile: 'í”„ë¡œí•„', upload: 'ì—…ë¡œë“œ', logout: 'ë¡œê·¸ì•„ì›ƒ', myUploads: 'ë‚´ ìž‘í’ˆë“¤',
                createTitle: 'ìƒˆ ìž‘í’ˆ ë§Œë“¤ê¸°', uploadMoment: 'ì‚¬ì§„ ì¶”ê°€', uploadVideo: 'ì¸ë„¤ì¼ ì—…ë¡œë“œ',
                uploadWebtoon: 'í‘œì§€ ì—…ë¡œë“œ', momentTitle: 'ì œëª©ì„ ìž…ë ¥í•˜ì„¸ìš”', videoTitle: 'ì˜ìƒ ì œëª©ì„ ìž…ë ¥í•˜ì„¸ìš”',
                webtoonTitle: 'ì›¹íˆ° ì œëª©ì„ ìž…ë ¥í•˜ì„¸ìš”', webtoonDesc: 'ìž‘í’ˆì˜ ì¤„ê±°ë¦¬ë‚˜ ì„¤ëª…ì„ ì ì–´ì£¼ì„¸ìš”...',
                commentPlace: 'ëŒ“ê¸€ ë‹¬ê¸°...', follow: 'íŒ”ë¡œìš°', following: 'íŒ”ë¡œìž‰', loginProcessing: 'ì²˜ë¦¬ ì¤‘...',
                errorAuth: 'ì¸ì¦ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.', noUploads: 'ì•„ì§ ì—…ë¡œë“œí•œ ìž‘í’ˆì´ ì—†ìŠµë‹ˆë‹¤.',
                chat: 'ì±„íŒ…', groupChat: 'ë‹¨ì²´ ì±„íŒ…', findGroup: 'ë°© ì°¾ê¸°', createGroup: 'ë°© ë§Œë“¤ê¸°',
                newMsg: 'ìƒˆ ë©”ì‹œì§€', editVideo: 'ë™ì˜ìƒ íŽ¸ì§‘', applyFilter: 'í•„í„° ì ìš©', groupName: 'ë°© ì´ë¦„ ìž…ë ¥',
                join: 'ì°¸ì—¬', editProfile: 'í”„ë¡œí•„ ìˆ˜ì •', save: 'ì €ìž¥', cancel: 'ì·¨ì†Œ',
                recommended: 'íšŒì›ë‹˜ì„ ìœ„í•œ ì¶”ì²œ', interestsUpdated: 'ê´€ì‹¬ì‚¬ê°€ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤!',
                exportData: 'ë°ì´í„° ë°±ì—… (JSON)'
            },
            en: {
                login: 'Log In', signup: 'Sign Up', signupLink: 'Sign Up', loginLink: 'Log In',
                noAccount: "Don't have an account?", hasAccount: 'Already have an account?',
                emailPlace: 'Email', pwPlace: 'Password', nickPlace: 'Nickname',
                loginFail: 'Login Failed: Please check your email or password.', emailDup: 'This email is already registered.',
                fillAll: 'Please fill in all fields.', welcome: 'Welcome', explore: 'Explore', nodes: 'Nodes',
                stories: 'Stories', profile: 'Profile', upload: 'Upload', logout: 'Log Out', myUploads: 'My Uploads',
                createTitle: 'Create New', uploadMoment: 'Add Photo', uploadVideo: 'Upload Thumb',
                uploadWebtoon: 'Upload Cover', momentTitle: 'Enter title', videoTitle: 'Enter video title',
                webtoonTitle: 'Enter webtoon title', webtoonDesc: 'Enter description...',
                commentPlace: 'Add a comment...', follow: 'Follow', following: 'Following',
                loginProcessing: 'Processing...', errorAuth: 'Authentication error. Please try again.',
                noUploads: 'No uploads yet.', chat: 'Chat', groupChat: 'Group Chat', findGroup: 'Find Group',
                createGroup: 'Create Group', newMsg: 'New Message', editVideo: 'Edit Video', applyFilter: 'Apply Filter',
                groupName: 'Enter group name', join: 'Join', editProfile: 'Edit Profile', save: 'Save', cancel: 'Cancel',
                recommended: 'Recommended for you', interestsUpdated: 'Interests updated!', exportData: 'Backup Data (JSON)'
            },
            zh: {
                login: 'ç™»å½•', signup: 'æ³¨å†Œå®Œæˆ', signupLink: 'æ³¨å†Œ', loginLink: 'ç™»å½•',
                noAccount: 'è¿˜æ²¡æœ‰è´¦å·ï¼Ÿ', hasAccount: 'å·²ç»æœ‰è´¦å·äº†ï¼Ÿ',
                emailPlace: 'é‚®ç®±', pwPlace: 'å¯†ç ', nickPlace: 'æ˜µç§°',
                loginFail: 'ç™»å½•å¤±è´¥ï¼šè¯·æ£€æŸ¥é‚®ç®±æˆ–å¯†ç ã€‚', emailDup: 'è¯¥é‚®ç®±å·²è¢«æ³¨å†Œã€‚',
                fillAll: 'è¯·å¡«å†™æ‰€æœ‰é¡¹ç›®ã€‚', welcome: 'æ¬¢è¿Ž', explore: 'æŽ¢ç´¢', nodes: 'èŠ‚ç‚¹',
                stories: 'æ•…äº‹', profile: 'ä¸ªäººèµ„æ–™', upload: 'ä¸Šä¼ ', logout: 'ç™»å‡º', myUploads: 'æˆ‘çš„ä½œå“',
                createTitle: 'åˆ›ä½œæ–°ä½œå“', uploadMoment: 'æ·»åŠ ç…§ç‰‡', uploadVideo: 'ä¸Šä¼ ç¼©ç•¥å›¾',
                uploadWebtoon: 'ä¸Šä¼ å°é¢', momentTitle: 'è¾“å…¥æ ‡é¢˜', videoTitle: 'è¾“å…¥è§†é¢‘æ ‡é¢˜',
                webtoonTitle: 'è¾“å…¥ç½‘æ¼«æ ‡é¢˜', webtoonDesc: 'è¯·è¾“å…¥ä½œå“ç®€ä»‹...',
                commentPlace: 'æ·»åŠ è¯„è®º...', follow: 'å…³æ³¨', following: 'å·²å…³æ³¨',
                loginProcessing: 'å¤„ç†ä¸­...', errorAuth: 'è®¤è¯é”™è¯¯ï¼Œè¯·é‡è¯•ã€‚', noUploads: 'æš‚æ— ä¸Šä¼ ä½œå“ã€‚',
                chat: 'èŠå¤©', groupChat: 'ç¾¤èŠ', findGroup: 'æŸ¥æ‰¾ç¾¤ç»„', createGroup: 'åˆ›å»ºç¾¤ç»„',
                newMsg: 'æ–°æ¶ˆæ¯', editVideo: 'ç¼–è¾‘è§†é¢‘', applyFilter: 'åº”ç”¨æ»¤é•œ', groupName: 'è¾“å…¥ç¾¤ç»„åç§°',
                join: 'åŠ å…¥', editProfile: 'ç¼–è¾‘èµ„æ–™', save: 'ä¿å­˜', cancel: 'å–æ¶ˆ',
                recommended: 'ä¸ºæ‚¨æŽ¨è', interestsUpdated: 'å…´è¶£å·²æ›´æ–°ï¼', exportData: 'æ•°æ®å¤‡ä»½ (JSON)'
            },
            es: {
                login: 'Iniciar SesiÃ³n', signup: 'Registrarse', signupLink: 'Registrarse', loginLink: 'Iniciar SesiÃ³n',
                noAccount: 'Â¿No tienes cuenta?', hasAccount: 'Â¿Ya tienes cuenta?',
                emailPlace: 'Correo electrÃ³nico', pwPlace: 'ContraseÃ±a', nickPlace: 'Apodo',
                loginFail: 'Error: Verifica tu correo o contraseÃ±a.', emailDup: 'El correo ya estÃ¡ registrado.',
                fillAll: 'Por favor llena todos los campos.', welcome: 'Bienvenido', explore: 'Explorar', nodes: 'Nodos',
                stories: 'Historias', profile: 'Perfil', upload: 'Subir', logout: 'Cerrar sesiÃ³n', myUploads: 'Mis Subidas',
                createTitle: 'Crear Nuevo', uploadMoment: 'AÃ±adir Foto', uploadVideo: 'Subir Miniatura',
                uploadWebtoon: 'Subir Portada', momentTitle: 'Introduce el tÃ­tulo', videoTitle: 'TÃ­tulo del video',
                webtoonTitle: 'TÃ­tulo del webtoon', webtoonDesc: 'Introduce descripciÃ³n...',
                commentPlace: 'AÃ±adir comentario...', follow: 'Seguir', following: 'Siguiendo',
                loginProcessing: 'Procesando...', errorAuth: 'Error de autenticaciÃ³n. IntÃ©ntalo de nuevo.',
                noUploads: 'AÃºn no hay subidas.', chat: 'Chat', groupChat: 'Chat Grupal', findGroup: 'Buscar Grupo',
                createGroup: 'Crear Grupo', newMsg: 'Nuevo Mensaje', editVideo: 'Editar Video', applyFilter: 'Aplicar Filtro',
                groupName: 'Nombre del grupo', join: 'Unirse', editProfile: 'Editar Perfil', save: 'Guardar', cancel: 'Cancelar',
                recommended: 'Recomendado para ti', interestsUpdated: 'Â¡Intereses actualizados!', exportData: 'Copia de seguridad (JSON)'
            },
            fr: {
                login: 'Connexion', signup: "S'inscrire", signupLink: "S'inscrire", loginLink: 'Connexion',
                noAccount: "Pas de compte ?", hasAccount: 'DÃ©jÃ  un compte ?',
                emailPlace: 'E-mail', pwPlace: 'Mot de passe', nickPlace: 'Surnom',
                loginFail: 'Ã‰chec : VÃ©rifiez votre e-mail ou mot de passe.', emailDup: 'Cet e-mail est dÃ©jÃ  enregistrÃ©.',
                fillAll: 'Veuillez remplir tous les champs.', welcome: 'Bienvenue', explore: 'Explorer', nodes: 'NÅ“uds',
                stories: 'Histoires', profile: 'Profil', upload: 'Publier', logout: 'DÃ©connexion', myUploads: 'Mes publications',
                createTitle: 'CrÃ©er Nouveau', uploadMoment: 'Ajouter Photo', uploadVideo: 'Miniature',
                uploadWebtoon: 'Couverture', momentTitle: 'Entrez le titre', videoTitle: 'Titre de la vidÃ©o',
                webtoonTitle: 'Titre du webtoon', webtoonDesc: 'Entrez la description...',
                commentPlace: 'Ajouter un commentaire...', follow: 'Suivre', following: 'AbonnÃ©',
                loginProcessing: 'Traitement...', errorAuth: 'Erreur d\'authentification. RÃ©essayez.',
                noUploads: 'Pas encore de publications.', chat: 'Discussion', groupChat: 'Groupe', findGroup: 'Trouver Groupe',
                createGroup: 'CrÃ©er Groupe', newMsg: 'Nouveau Message', editVideo: 'Ã‰diter VidÃ©o', applyFilter: 'Appliquer Filtre',
                groupName: 'Nom du groupe', join: 'Rejoindre', editProfile: 'Modifier Profil', save: 'Sauvegarder', cancel: 'Annuler',
                recommended: 'RecommandÃ© pour vous', interestsUpdated: 'IntÃ©rÃªts mis Ã  jour !', exportData: 'Sauvegarde (JSON)'
            },
            ja: {
                login: 'ãƒ­ã‚°ã‚¤ãƒ³', signup: 'ç™»éŒ²å®Œäº†', signupLink: 'æ–°è¦ç™»éŒ²', loginLink: 'ãƒ­ã‚°ã‚¤ãƒ³',
                noAccount: 'ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ãŠæŒã¡ã§ãªã„ã§ã™ã‹ï¼Ÿ', hasAccount: 'ã™ã§ã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ãŠæŒã¡ã§ã™ã‹ï¼Ÿ',
                emailPlace: 'ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹', pwPlace: 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰', nickPlace: 'ãƒ‹ãƒƒã‚¯ãƒãƒ¼ãƒ ',
                loginFail: 'ãƒ­ã‚°ã‚¤ãƒ³å¤±æ•—ï¼šãƒ¡ãƒ¼ãƒ«ã¾ãŸã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚', emailDup: 'ã“ã®ãƒ¡ãƒ¼ãƒ«ã¯æ—¢ã«ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã™ã€‚',
                fillAll: 'ã™ã¹ã¦ã®é …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚', welcome: 'ã‚ˆã†ã“ã', explore: 'æŽ¢ç´¢', nodes: 'ãƒŽãƒ¼ãƒ‰',
                stories: 'ã‚¹ãƒˆãƒ¼ãƒªãƒ¼', profile: 'ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«', upload: 'ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰', logout: 'ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ', myUploads: 'ç§ã®ä½œå“',
                createTitle: 'æ–°è¦ä½œæˆ', uploadMoment: 'å†™çœŸè¿½åŠ ', uploadVideo: 'ã‚µãƒ ãƒã‚¤ãƒ«',
                uploadWebtoon: 'è¡¨ç´™ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰', momentTitle: 'ã‚¿ã‚¤ãƒˆãƒ«ã‚’å…¥åŠ›', videoTitle: 'å‹•ç”»ã‚¿ã‚¤ãƒˆãƒ«',
                webtoonTitle: 'ã‚¦ã‚§ãƒ–ãƒˆã‚¥ãƒ¼ãƒ³ã®ã‚¿ã‚¤ãƒˆãƒ«', webtoonDesc: 'èª¬æ˜Žã‚’å…¥åŠ›...',
                commentPlace: 'ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¿½åŠ ...', follow: 'ãƒ•ã‚©ãƒ­ãƒ¼', following: 'ãƒ•ã‚©ãƒ­ãƒ¼ä¸­',
                loginProcessing: 'å‡¦ç†ä¸­...', errorAuth: 'èªè¨¼ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚',
                noUploads: 'ã¾ã ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸä½œå“ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚', chat: 'ãƒãƒ£ãƒƒãƒˆ', groupChat: 'ã‚°ãƒ«ãƒ¼ãƒ—ãƒãƒ£ãƒƒãƒˆ', findGroup: 'ã‚°ãƒ«ãƒ¼ãƒ—ã‚’æŽ¢ã™',
                createGroup: 'ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆ', newMsg: 'æ–°ã—ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸', editVideo: 'å‹•ç”»ç·¨é›†', applyFilter: 'ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨',
                groupName: 'ã‚°ãƒ«ãƒ¼ãƒ—åã‚’å…¥åŠ›', join: 'å‚åŠ ', editProfile: 'ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç·¨é›†', save: 'ä¿å­˜', cancel: 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«',
                recommended: 'ã‚ãªãŸã¸ã®ãŠã™ã™ã‚', interestsUpdated: 'èˆˆå‘³ãŒæ›´æ–°ã•ã‚Œã¾ã—ãŸï¼', exportData: 'ãƒ‡ãƒ¼ã‚¿ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ— (JSON)'
            }
        };

        // --- Mock Data ---
        const INITIAL_POSTS = [
            { id: 1, category: 'Moment', author: 'Sapcore_Creator', authorAvatar: 'https://i.pravatar.cc/100?u=Sapcore_Creator', title: 'ë¯¸ëž˜ì˜ ì†Œì…œ ë¯¸ë””ì–´ëŠ” ì–´ë–¤ ëª¨ìŠµì¼ê¹Œìš”?', preview: 'https://images.unsplash.com/photo-1618005182384-a83a8bd57fbe?w=800', stats: { engagement: '98%', interactions: '2.4k' }, tags: ['design', 'future', 'tech'] },
            { id: 2, category: 'Concept', author: 'Tech_Flow', authorAvatar: 'https://i.pravatar.cc/100?u=Tech_Flow', title: 'SAPCORE ë””ìžì¸ ì‹œìŠ¤í…œ ê°€ì´ë“œë¼ì¸', preview: 'https://images.unsplash.com/photo-1633356122544-f134324a6cee?w=800', stats: { engagement: '85%', interactions: '1.1k' }, tags: ['ui/ux', 'design', 'system'] }
        ];
        const INITIAL_COMMENTS = {
            1: [ { id: 101, user: 'DesignLover', text: 'ì •ë§ ê¸°ëŒ€ë˜ëŠ” ë¹„ì „ì´ë„¤ìš”! ðŸ˜Ž', avatar: 'https://i.pravatar.cc/150?u=DesignLover' }, { id: 102, user: 'Future_Dev', text: 'ë¹¨ë¦¬ ì¨ë³´ê³  ì‹¶ìŠµë‹ˆë‹¤.', avatar: 'https://i.pravatar.cc/150?u=Future_Dev' } ]
        };
        const INITIAL_VIDEOS = [
            { id: 1, title: 'Generative Art Motion', author: 'Visual_X', views: '1.5M', thumb: 'https://images.unsplash.com/photo-1550745165-9bc0b252726f?w=600', tags: ['art', 'motion', 'design'] },
            { id: 2, title: 'Neon Night Cityscape', author: 'CyberRunner', views: '890K', thumb: 'https://images.unsplash.com/photo-1519608487953-e999c86e7455?w=600', tags: ['cyberpunk', 'city', 'future'] }
        ];
        const INITIAL_WEBTOONS = [
            { id: 1, title: 'ì¹¨ë¬µì˜ ê¶¤ë„', desc: 'ìš°ì£¼ë¥¼ ì—¬í–‰í•˜ëŠ” ê³ ë…í•œ í•­í•´ì¼ì§€', score: '9.9', author: 'ë£¨ë‚˜', img: 'https://images.unsplash.com/photo-1571330735066-03aaa9429d89?w=400', tags: ['space', 'sci-fi'] },
            { id: 2, title: 'ë„¤ì˜¨ ì‹ ë“œë¡¬', desc: 'ì‚¬ì´ë²„íŽ‘í¬ ë„ì‹œì˜ ë¯¸ìŠ¤í„°ë¦¬', score: '9.8', author: 'ì œì´', img: 'https://images.unsplash.com/photo-1541562232579-512a21359920?w=400', tags: ['cyberpunk', 'mystery'] }
        ];
        const INITIAL_CHAT_GROUPS = [
            { id: 1, name: 'Webtoon Artists', members: 124, lastMsg: 'ìƒˆë¡œìš´ ì±•í„° ì–¸ì œ ë‚˜ì˜¤ë‚˜ìš”?' },
            { id: 2, name: 'Video Creators', members: 89, lastMsg: 'ì´ë²ˆ íŽ¸ì§‘ íš¨ê³¼ ëŒ€ë°•ì´ë„¤ìš”' },
            { id: 3, name: 'Global Friends', members: 350, lastMsg: 'Hello everyone!' }
        ];

        // --- App Component ---
        const App = () => {
            const [firebaseUser, setFirebaseUser] = useState(null);
            const [currentUser, setCurrentUser] = useState(null);
            const [isLoading, setIsLoading] = useState(false);
            const [loginError, setLoginError] = useState('');
            const [language, setLanguage] = useState('ko');
            const t = TRANSLATIONS[language];

            const [activeTab, setActiveTab] = useState('explore');
            const [liked, setLiked] = useState({});
            const [posts, setPosts] = useState(INITIAL_POSTS);
            const [videos, setVideos] = useState(INITIAL_VIDEOS);
            const [webtoons, setWebtoons] = useState(INITIAL_WEBTOONS);
            const [followingList, setFollowingList] = useState([]);
            const [commentsData, setCommentsData] = useState(INITIAL_COMMENTS);
            const [activePostForComments, setActivePostForComments] = useState(null);
            const [commentInput, setCommentInput] = useState('');

            const [showChatModal, setShowChatModal] = useState(false);
            const [chatGroups, setChatGroups] = useState(INITIAL_CHAT_GROUPS);
            const [publicGroups, setPublicGroups] = useState([
                { id: 101, name: 'K-Pop Fans', members: 500, desc: 'BTS, Blackpink...' },
                { id: 102, name: 'Coding Study', members: 42, desc: 'React & Firebase' }
            ]);
            const [activeChatTab, setActiveChatTab] = useState('my');
            const [newGroupName, setNewGroupName] = useState('');
            const [notification, setNotification] = useState(null);

            const [showCompose, setShowCompose] = useState(false);
            const [uploadType, setUploadType] = useState('moment');
            const [inputText, setInputText] = useState('');
            const [inputDesc, setInputDesc] = useState('');
            const [previewUrl, setPreviewUrl] = useState(null);
            const [isEditingVideo, setIsEditingVideo] = useState(false);
            const [videoFilter, setVideoFilter] = useState('');

            const [isEditingProfile, setIsEditingProfile] = useState(false);
            const [editNameInput, setEditNameInput] = useState('');
            const [userInterests, setUserInterests] = useState([]);

            const [authMode, setAuthMode] = useState('login');
            const [authForm, setAuthForm] = useState({ email: '', password: '', nickname: '', avatar: null });

            // Notification Sim
            useEffect(() => {
                if (currentUser) {
                    const timer = setTimeout(() => {
                        setNotification({
                            id: Date.now(),
                            title: t.newMsg,
                            message: 'Webtoon Artists: ì•ˆë…•í•˜ì„¸ìš”!',
                            icon: MessageSquare
                        });
                        setTimeout(() => setNotification(null), 3000);
                    }, 5000);
                    return () => clearTimeout(timer);
                }
            }, [currentUser, t.newMsg]);

            // Firebase Auth
            useEffect(() => {
                if (!auth) return;
                const initAuth = async () => {
                    if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                        await signInWithCustomToken(auth, __initial_auth_token);
                    } else {
                        await signInAnonymously(auth);
                    }
                };
                initAuth();
                
                const unsubscribe = onAuthStateChanged(auth, (user) => {
                    setFirebaseUser(user);
                });
                return () => unsubscribe();
            }, []);

            // Handlers
            const handleExportData = () => {
                if (!currentUser) return;
                const exportData = {
                    userProfile: currentUser,
                    myPosts: posts.filter(p => p.author === currentUser.nickname),
                    myVideos: videos.filter(v => v.author === currentUser.nickname),
                    myWebtoons: webtoons.filter(w => w.author === currentUser.nickname),
                    following: followingList,
                    interests: userInterests,
                    exportedAt: new Date().toISOString(),
                    appVersion: 'Sapcore 1.0'
                };
                const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `sapcore_backup_${currentUser.nickname}.json`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
            };

            const getRecommendationScore = (tags) => {
                if (!tags || tags.length === 0) return 0;
                const matches = tags.filter(tag => userInterests.includes(tag));
                return matches.length;
            };

            const handleImageChange = (e, setUrlFunc) => {
                const file = e.target.files[0];
                if (file) {
                    const url = URL.createObjectURL(file);
                    setUrlFunc(url);
                }
            };

            const toggleFollow = (authorName) => {
                if (authorName === currentUser.nickname) return;
                if (followingList.includes(authorName)) {
                    setFollowingList(followingList.filter(name => name !== authorName));
                } else {
                    setFollowingList([...followingList, authorName]);
                }
            };

            const handleLike = (id, tags) => {
                setLiked(prev => ({...prev, [id]: !prev[id]}));
                if (tags && tags.length > 0) {
                    const newInterests = [...new Set([...userInterests, ...tags])];
                    setUserInterests(newInterests);
                }
            };

            const handleCommentSubmit = () => {
                if (!commentInput.trim() || !activePostForComments) return;
                const newComment = {
                    id: Date.now(), user: currentUser.nickname, avatar: currentUser.avatar, text: commentInput
                };
                setCommentsData(prev => ({
                    ...prev, [activePostForComments]: [...(prev[activePostForComments] || []), newComment]
                }));
                setCommentInput('');
            };

            const handleCreateGroup = () => {
                if (!newGroupName.trim()) return;
                const newGroup = { id: Date.now(), name: newGroupName, members: 1, lastMsg: 'New group created.' };
                setChatGroups([newGroup, ...chatGroups]);
                setNewGroupName('');
            };

            const handleJoinGroup = (group) => {
                const exists = chatGroups.find(g => g.id === group.id);
                if (!exists) {
                    setChatGroups([{ ...group, lastMsg: 'Joined.' }, ...chatGroups]);
                    alert(`${group.name} Joined!`);
                } else {
                    alert('Already joined.');
                }
            };

            const handleNameUpdate = () => {
                if (editNameInput.trim()) {
                    setCurrentUser(prev => ({ ...prev, nickname: editNameInput }));
                    setIsEditingProfile(false);
                }
            };

            const handleAuthSubmit = async (e) => {
                e.preventDefault();
                setLoginError('');
                
                // ë¡œì»¬ ëª¨ë“œ (DBê°€ ì—†ì„ ë•Œ) fallback
                if (!db) {
                    const mockUser = {
                        email: authForm.email,
                        nickname: authForm.nickname || 'DemoUser',
                        avatar: authForm.avatar || `https://i.pravatar.cc/150?u=${authForm.email}`,
                        stats: { works: 0, level: 1 }
                    };
                    setCurrentUser(mockUser);
                    setFollowingList([]);
                    return;
                }

                if (!firebaseUser) return;
                setIsLoading(true);
                const usersRef = collection(db, 'artifacts', appId, 'public', 'data', 'aura_users');

                try {
                    if (authMode === 'signup') {
                        if (!authForm.email || !authForm.password || !authForm.nickname) {
                            setLoginError(t.fillAll); setIsLoading(false); return;
                        }
                        const q = query(usersRef, where("email", "==", authForm.email));
                        const querySnapshot = await getDocs(q);
                        if (!querySnapshot.empty) { setLoginError(t.emailDup); setIsLoading(false); return; }

                        const newUser = {
                            email: authForm.email, password: authForm.password, nickname: authForm.nickname,
                            avatar: authForm.avatar || `https://i.pravatar.cc/150?u=${authForm.email}`,
                            stats: { works: 0, level: 1 }
                        };
                        await addDoc(usersRef, newUser);
                        setCurrentUser(newUser); setFollowingList([]);
                    } else {
                        const q = query(usersRef, where("email", "==", authForm.email));
                        const querySnapshot = await getDocs(q);
                        if (querySnapshot.empty) { setLoginError(t.loginFail); setIsLoading(false); return; }

                        let foundUser = null;
                        querySnapshot.forEach((doc) => {
                            const userData = doc.data();
                            if (userData.password === authForm.password) foundUser = userData;
                        });

                        if (foundUser) { setCurrentUser(foundUser); setFollowingList([]); }
                        else { setLoginError(t.loginFail); }
                    }
                } catch (error) {
                    console.error("Auth Error:", error);
                    setLoginError(t.errorAuth);
                }
                setIsLoading(false);
            };

            const handleLogout = () => {
                setCurrentUser(null); setAuthForm({ email: '', password: '', nickname: '', avatar: null });
                setActiveTab('explore'); setFollowingList([]); setLoginError(''); setUserInterests([]);
            };

            const handleSubmit = () => {
                if (!inputText.trim()) return;
                const commonData = {
                    id: Date.now(), author: currentUser.nickname, authorAvatar: currentUser.avatar,
                    isNew: true, tags: ['new', 'user_content']
                };
                const imageToUse = previewUrl || `https://picsum.photos/seed/${Date.now()}/800/600`;

                if (uploadType === 'moment') {
                    setPosts([{ ...commonData, category: 'My Moment', title: inputText, preview: imageToUse, stats: { engagement: 'New', interactions: '0' } }, ...posts]);
                    setActiveTab('explore');
                } else if (uploadType === 'video') {
                    setVideos([{ ...commonData, title: inputText, thumb: imageToUse, views: '0', filter: videoFilter }, ...videos]);
                    setActiveTab('nodes');
                } else if (uploadType === 'webtoon') {
                    setWebtoons([{ ...commonData, title: inputText, desc: inputDesc || 'No Desc', img: imageToUse, score: '10.0' }, ...webtoons]);
                    setActiveTab('stories');
                }
                
                const updatedUser = { ...currentUser, stats: { ...currentUser.stats, works: currentUser.stats.works + 1 } };
                setCurrentUser(updatedUser);
                setInputText(''); setInputDesc(''); setPreviewUrl(null); setShowCompose(false); setIsEditingVideo(false); setVideoFilter('');
            };

            if (!currentUser) {
                return (
                    <div className="max-w-md mx-auto min-h-screen bg-white flex flex-col items-center justify-center p-8 relative overflow-hidden font-sans">
                        <div className="absolute top-[-10%] left-[-10%] w-[50%] h-[30%] bg-purple-200 rounded-full blur-[100px] opacity-50"></div>
                        <div className="absolute bottom-[-10%] right-[-10%] w-[50%] h-[30%] bg-blue-200 rounded-full blur-[100px] opacity-50"></div>
                        <div className="z-10 w-full relative">
                            <div className="flex justify-center gap-3 mb-8">
                                {['ko', 'en', 'es', 'fr', 'ja', 'zh'].map(lang => (
                                    <button key={lang} onClick={() => setLanguage(lang)} className={`w-8 h-8 rounded-full border flex items-center justify-center text-[10px] font-bold uppercase transition-all ${language === lang ? 'bg-black text-white border-black scale-110 shadow-md' : 'bg-white text-gray-400 border-gray-200 hover:border-gray-400'}`}>{lang}</button>
                                ))}
                            </div>
                            <div className="flex flex-col items-center mb-10">
                                <div className="w-16 h-16 bg-black rounded-2xl flex items-center justify-center rotate-12 shadow-2xl mb-4">
                                    <Gem size={32} className="text-white fill-white" />
                                </div>
                                <h1 className="text-4xl font-black tracking-tighter italic">SAPCORE</h1>
                                <p className="text-gray-400 font-medium mt-2">Sapphire AI Core Universe</p>
                            </div>
                            <form onSubmit={handleAuthSubmit} className="space-y-4">
                                {authMode === 'signup' && (
                                    <div className="animate-in slide-in-from-bottom-5 duration-300 space-y-4">
                                        <div className="flex justify-center mb-6">
                                            <label className="relative cursor-pointer group">
                                                <div className="w-24 h-24 rounded-full bg-gray-100 border-2 border-dashed border-gray-300 flex items-center justify-center overflow-hidden hover:border-black transition-colors">
                                                    {authForm.avatar ? <img src={authForm.avatar} className="w-full h-full object-cover" /> : <Camera className="text-gray-400" />}
                                                </div>
                                                <div className="absolute bottom-0 right-0 bg-black text-white p-1.5 rounded-full shadow-lg"><Plus size={12} /></div>
                                                <input type="file" accept="image/*" className="hidden" onChange={(e) => handleImageChange(e, (url) => setAuthForm({...authForm, avatar: url}))} />
                                            </label>
                                        </div>
                                        <div className="relative"><User className="absolute left-4 top-3.5 text-gray-400" size={20} /><input type="text" placeholder={t.nickPlace} className="w-full bg-gray-50 border border-gray-200 rounded-2xl py-3 pl-12 pr-4 outline-none focus:border-black focus:ring-1" value={authForm.nickname} onChange={(e) => setAuthForm({...authForm, nickname: e.target.value})} /></div>
                                    </div>
                                )}
                                <div className="relative"><Mail className="absolute left-4 top-3.5 text-gray-400" size={20} /><input type="email" placeholder={t.emailPlace} className="w-full bg-gray-50 border border-gray-200 rounded-2xl py-3 pl-12 pr-4 outline-none focus:border-black focus:ring-1" value={authForm.email} onChange={(e) => setAuthForm({...authForm, email: e.target.value})} /></div>
                                <div className="relative"><Lock className="absolute left-4 top-3.5 text-gray-400" size={20} /><input type="password" placeholder={t.pwPlace} className="w-full bg-gray-50 border border-gray-200 rounded-2xl py-3 pl-12 pr-4 outline-none focus:border-black focus:ring-1" value={authForm.password} onChange={(e) => setAuthForm({...authForm, password: e.target.value})} /></div>
                                <button type="submit" disabled={isLoading} className="w-full bg-black text-white py-4 rounded-2xl font-bold text-lg shadow-xl hover:scale-[1.02] active:scale-95 transition-all mt-4 disabled:opacity-50">{isLoading ? t.loginProcessing : (authMode === 'login' ? t.login : t.signup)}</button>
                                {loginError && <div className="text-center mt-2"><p className="text-red-500 text-xs font-bold bg-red-50 py-1 px-3 rounded-full inline-block">{loginError}</p></div>}
                            </form>
                            <div className="mt-6 text-center"><p className="text-gray-400 text-sm">{authMode === 'login' ? t.noAccount : t.hasAccount}</p><button onClick={() => { setAuthMode(authMode === 'login' ? 'signup' : 'login'); setAuthForm({ email: '', password: '', nickname: '', avatar: null }); setLoginError(''); }} className="text-black font-bold text-sm mt-1 hover:underline">{authMode === 'login' ? t.signupLink : t.loginLink}</button></div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="max-w-md mx-auto min-h-screen bg-[#F8F9FA] pb-24 font-sans antialiased text-gray-900 relative">
                    {/* Notifications */}
                    {notification && (
                        <div className="fixed top-4 left-4 right-4 z-[70] bg-white border border-gray-100 shadow-xl rounded-2xl p-4 flex items-center gap-3 animate-bounce">
                            <div className="bg-green-100 p-2 rounded-full text-green-600"><notification.icon size={20} /></div>
                            <div><p className="text-xs font-bold text-gray-500">{notification.title}</p><p className="text-sm font-bold">{notification.message}</p></div>
                        </div>
                    )}

                    {/* Header */}
                    <div className="sticky top-0 z-40 flex justify-between items-center px-6 py-4 bg-white/70 backdrop-blur-xl">
                        <div className="flex items-center gap-2"><div className="w-8 h-8 bg-black rounded-xl flex items-center justify-center rotate-12 shadow-lg"><Gem size={18} className="text-white fill-white" /></div><span className="text-xl font-black tracking-tighter italic">SAPCORE</span></div>
                        <div className="flex items-center gap-3">
                            <button onClick={() => setShowChatModal(true)} className="p-2 bg-white rounded-full shadow-sm hover:bg-gray-50"><MessageSquare size={20} className="text-gray-700" /></button>
                            <div className="bg-white shadow-sm border border-gray-100 rounded-full px-4 py-1.5 flex items-center gap-2"><Flame size={14} className="text-orange-500 fill-orange-500" /><span className="text-xs font-bold">{1240 + currentUser.stats.works * 50} XP</span></div>
                        </div>
                    </div>

                    <main>
                        {activeTab === 'explore' && (
                            <div className="animate-pulse-once">
                                <div className="mb-6 px-6 pt-6"><h2 className="text-3xl font-black tracking-tighter text-gray-900 leading-none">{t.explore}</h2><p className="text-sm text-gray-400 font-medium mt-1">{t.welcome}, {currentUser.nickname}!</p></div>
                                <div className="px-6 space-y-6">
                                    {[...posts].sort((a, b) => getRecommendationScore(b.tags) - getRecommendationScore(a.tags)).map(card => (
                                        <div key={card.id} className="relative group overflow-hidden rounded-[32px] bg-white border border-gray-100 shadow-xl shadow-gray-200/50">
                                            <div className="p-5 flex justify-between items-start mb-4">
                                                <div className="flex items-center gap-3">
                                                    <div className="w-10 h-10 rounded-full bg-gray-200 overflow-hidden"><img src={card.authorAvatar} alt="avatar" /></div>
                                                    <div><span className="text-xs font-bold text-gray-900 block">@{card.author}</span>
                                                    {card.author !== currentUser.nickname && <button onClick={() => toggleFollow(card.author)} className="text-[10px] font-bold px-2 py-0.5 rounded-full mt-0.5 flex items-center gap-1 bg-indigo-50 text-indigo-600">{followingList.includes(card.author) ? <><UserCheck size={10} /> {t.following}</> : <><UserPlus size={10} /> {t.follow}</>}</button>}
                                                    </div>
                                                </div>
                                                <div className="flex flex-col items-end gap-1"><div className="px-2 py-1 rounded-lg bg-gray-50 text-[10px] font-black uppercase">{card.category}</div>{getRecommendationScore(card.tags) > 0 && <div className="flex items-center gap-1 text-[10px] font-bold text-indigo-500"><Sparkles size={10} /> {t.recommended}</div>}</div>
                                            </div>
                                            <h3 className="px-5 text-xl font-bold leading-tight mb-2">{card.title}</h3>
                                            <div className="relative aspect-[16/10] mx-4 mb-4 rounded-2xl overflow-hidden shadow-inner bg-gray-100"><img src={card.preview} className="w-full h-full object-cover" /></div>
                                            <div className="px-5 pb-5 flex justify-between items-center border-t border-gray-50 pt-4">
                                                <div className="flex gap-4">
                                                    <button onClick={() => handleLike(card.id, card.tags)} className={`flex items-center gap-1 text-xs font-bold ${liked[card.id] ? 'text-red-500' : 'text-gray-400'}`}><Heart size={16} className={liked[card.id] ? 'fill-current' : ''} /> Like</button>
                                                    <button onClick={() => setActivePostForComments(card.id)} className="flex items-center gap-1 text-xs font-bold text-gray-400"><MessageSquare size={16} /> Comment</button>
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {activeTab === 'nodes' && (
                            <div className="px-6 space-y-8">
                                <div className="mb-6 pt-6"><h2 className="text-3xl font-black">{t.nodes}</h2></div>
                                {videos.map(node => (
                                    <div key={node.id} className="relative rounded-[24px] overflow-hidden bg-black shadow-2xl">
                                        <img src={node.thumb} className={`w-full aspect-video object-cover opacity-80 ${node.filter || ''}`} />
                                        <div className="absolute inset-0 flex flex-col justify-between p-6">
                                            <div className="flex justify-end"><div className="bg-white/10 backdrop-blur-md px-3 py-1 rounded-full text-[10px] text-white font-bold">{node.views} views</div></div>
                                            <div><p className="text-white text-lg font-bold">{node.title}</p><p className="text-white/60 text-xs font-medium">By {node.author}</p></div>
                                        </div>
                                        <div className="absolute inset-0 flex items-center justify-center pointer-events-none"><div className="w-12 h-12 bg-white rounded-2xl flex items-center justify-center"><PlayCircle size={28} /></div></div>
                                    </div>
                                ))}
                            </div>
                        )}

                        {activeTab === 'stories' && (
                            <div className="px-6 grid gap-6">
                                <div className="mb-6 pt-6"><h2 className="text-3xl font-black">{t.stories}</h2></div>
                                {webtoons.map(story => (
                                    <div key={story.id} className="flex gap-4 bg-white p-3 rounded-[28px] border border-gray-100 shadow-sm">
                                        <div className="w-24 h-32 rounded-2xl overflow-hidden flex-shrink-0 relative"><img src={story.img} className="w-full h-full object-cover" /></div>
                                        <div className="flex flex-col justify-between py-1 flex-1">
                                            <div>
                                                <div className="flex items-center gap-1 mb-1"><Star size={12} className="text-yellow-400 fill-yellow-400" /><span className="text-[10px] font-black">{story.score}</span></div>
                                                <h4 className="text-lg font-bold tracking-tight mb-1">{story.title}</h4>
                                                <p className="text-xs text-gray-500 line-clamp-2">{story.desc}</p>
                                            </div>
                                            <button className="flex items-center gap-2 text-xs font-black text-black mt-2">Read Now <div className="w-6 h-6 rounded-full bg-black text-white flex items-center justify-center"><Plus size={14} /></div></button>
                                        </div>
                                    </div>
                                ))}
                            </div>
                        )}

                        {activeTab === 'profile' && (
                            <div className="px-6 py-8">
                                <div className="flex flex-col items-center">
                                    <div className="relative mb-6 w-32 h-32 rounded-[48px] bg-gradient-to-br from-indigo-500 via-purple-500 to-pink-500 p-1 rotate-6">
                                        <img src={currentUser.avatar} className="w-full h-full rounded-[44px] border-4 border-white object-cover -rotate-6" />
                                    </div>
                                    {isEditingProfile ? (
                                        <div className="flex items-center gap-2 mb-1">
                                            <input type="text" value={editNameInput} onChange={(e) => setEditNameInput(e.target.value)} className="text-2xl font-black text-center bg-gray-100 rounded-lg px-2 w-48" autoFocus />
                                            <button onClick={handleNameUpdate} className="p-2 bg-black text-white rounded-full"><Check size={16} /></button>
                                            <button onClick={() => setIsEditingProfile(false)} className="p-2 bg-gray-200 text-gray-500 rounded-full"><X size={16} /></button>
                                        </div>
                                    ) : (
                                        <div className="flex items-center gap-2 mb-1"><h2 className="text-2xl font-black italic uppercase">{currentUser.nickname}</h2><button onClick={() => { setEditNameInput(currentUser.nickname); setIsEditingProfile(true); }} className="p-1.5 bg-gray-50 text-gray-400 rounded-full"><Edit2 size={14} /></button></div>
                                    )}
                                    <p className="text-gray-400 text-sm font-medium mb-6">{currentUser.email}</p>
                                    <div className="flex gap-12 mb-8 text-center">
                                        <div><p className="text-[10px] text-gray-400 font-black uppercase">Works</p><p className="text-xl font-black">{currentUser.stats.works}</p></div>
                                        <div><p className="text-[10px] text-gray-400 font-black uppercase">{t.following}</p><p className="text-xl font-black text-indigo-600">{followingList.length}</p></div>
                                        <div><p className="text-[10px] text-gray-400 font-black uppercase">Followers</p><p className="text-xl font-black">0</p></div>
                                    </div>
                                    <div className="flex gap-2 mb-4 w-full">
                                        <button onClick={handleExportData} className="flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-gray-900 text-white rounded-2xl text-xs font-bold hover:bg-black transition-colors"><Download size={14} /> {t.exportData}</button>
                                        <button onClick={handleLogout} className="flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-gray-100 text-red-500 rounded-2xl text-xs font-bold hover:bg-gray-200 transition-colors"><LogOut size={14} /> {t.logout}</button>
                                    </div>
                                </div>
                                {/* My Uploads Grid */}
                                <div className="grid grid-cols-3 gap-2 mt-6">
                                    {posts.filter(p => p.author === currentUser.nickname).map(p => <div key={`p-${p.id}`} className="aspect-square bg-gray-100 rounded-xl overflow-hidden"><img src={p.preview} className="w-full h-full object-cover" /></div>)}
                                    {videos.filter(v => v.author === currentUser.nickname).map(v => <div key={`v-${v.id}`} className="aspect-square bg-black rounded-xl overflow-hidden relative"><img src={v.thumb} className={`w-full h-full object-cover opacity-80 ${v.filter}`} /><PlayCircle className="absolute inset-0 m-auto text-white" /></div>)}
                                    {webtoons.filter(w => w.author === currentUser.nickname).map(w => <div key={`w-${w.id}`} className="aspect-square bg-gray-100 rounded-xl overflow-hidden relative"><img src={w.img} className="w-full h-full object-cover" /><span className="absolute bottom-1 right-1 bg-black text-white text-[8px] px-1 rounded">TOON</span></div>)}
                                </div>
                            </div>
                        )}
                    </main>

                    {/* Modals & Floating UI (Chat, Compose, TabBar) */}
                    {showChatModal && (
                        <div className="fixed inset-0 z-[60] bg-black/50 backdrop-blur-sm flex items-center justify-center p-4">
                            <div className="bg-white w-full max-w-sm rounded-[32px] h-[70vh] flex flex-col shadow-2xl overflow-hidden">
                                <div className="p-4 bg-gray-50 flex justify-between items-center border-b border-gray-100"><h3 className="font-black text-lg">{t.chat}</h3><button onClick={() => setShowChatModal(false)} className="p-2 bg-white rounded-full"><X size={18} /></button></div>
                                <div className="flex p-2 gap-2 bg-gray-50"><button onClick={() => setActiveChatTab('my')} className={`flex-1 py-2 text-xs font-bold rounded-xl ${activeChatTab === 'my' ? 'bg-black text-white' : 'text-gray-400'}`}>{t.groupChat}</button><button onClick={() => setActiveChatTab('find')} className={`flex-1 py-2 text-xs font-bold rounded-xl ${activeChatTab === 'find' ? 'bg-black text-white' : 'text-gray-400'}`}>{t.findGroup}</button></div>
                                <div className="flex-1 overflow-y-auto p-4 space-y-3">
                                    {activeChatTab === 'my' ? (
                                        <>
                                            <div className="flex gap-2 mb-4"><input type="text" value={newGroupName} onChange={e => setNewGroupName(e.target.value)} placeholder={t.groupName} className="flex-1 bg-gray-100 rounded-xl px-3 text-sm border-none" /><button onClick={handleCreateGroup} className="p-2 bg-black text-white rounded-xl"><Plus size={18} /></button></div>
                                            {chatGroups.map(group => <div key={group.id} className="flex items-center gap-3 p-3 bg-white border border-gray-100 rounded-2xl"><div className="w-10 h-10 rounded-full bg-indigo-100 flex items-center justify-center text-indigo-600"><Users size={20} /></div><div className="flex-1"><p className="font-bold text-sm">{group.name}</p><p className="text-xs text-gray-400">{group.lastMsg}</p></div></div>)}
                                        </>
                                    ) : (
                                        publicGroups.map(group => <div key={group.id} className="p-4 border border-gray-100 rounded-2xl flex justify-between items-center"><div><p className="font-bold">{group.name}</p><p className="text-xs text-gray-400">{group.members} members</p></div><button onClick={() => handleJoinGroup(group)} className="px-3 py-1 bg-black text-white text-xs font-bold rounded-lg">{t.join}</button></div>)
                                    )}
                                </div>
                            </div>
                        </div>
                    )}

                    {showCompose && (
                        <div className="fixed inset-0 z-[60] bg-black/80 backdrop-blur-sm flex items-end sm:items-center justify-center p-4">
                            <div className="bg-white w-full max-w-sm rounded-[32px] p-6 shadow-2xl relative">
                                <button onClick={() => { setShowCompose(false); setPreviewUrl(null); setInputText(''); setIsEditingVideo(false); setVideoFilter(''); }} className="absolute top-6 right-6 p-2 bg-gray-100 rounded-full"><X size={20} /></button>
                                <h3 className="text-xl font-black mb-4">{t.createTitle}</h3>
                                <div className="flex gap-2 mb-6 bg-gray-100 p-1 rounded-2xl">
                                    {[{ id: 'moment', icon: Compass }, { id: 'video', icon: Film }, { id: 'webtoon', icon: PenTool }].map(type => (
                                        <button key={type.id} onClick={() => { setUploadType(type.id); setPreviewUrl(null); setIsEditingVideo(false); }} className={`flex-1 py-3 rounded-xl text-xs font-bold flex items-center justify-center gap-1 ${uploadType === type.id ? 'bg-white shadow-md text-black' : 'text-gray-400'}`}><type.icon size={14} /> {type.id}</button>
                                    ))}
                                </div>
                                <div className="space-y-4 mb-6">
                                    <input type="text" value={inputText} onChange={(e) => setInputText(e.target.value)} placeholder={t.momentTitle} className="w-full p-4 bg-gray-50 rounded-2xl border-none focus:ring-2 focus:ring-black/5" />
                                    {uploadType === 'video' && previewUrl && (
                                        <div className="bg-gray-50 p-4 rounded-2xl border border-gray-100">
                                            <div className="flex justify-between items-center mb-3"><span className="text-xs font-bold flex items-center gap-1"><Scissors size={14} /> {t.editVideo}</span><button onClick={() => setIsEditingVideo(!isEditingVideo)} className="text-[10px] bg-black text-white px-2 py-1 rounded">{isEditingVideo ? 'Close' : 'Edit'}</button></div>
                                            {isEditingVideo && <div className="grid grid-cols-3 gap-2">{['none', 'grayscale(100%)', 'sepia(80%)', 'saturate(200%)', 'hue-rotate(90deg)', 'invert(100%)'].map((filter, i) => <button key={i} onClick={() => setVideoFilter(filter === 'none' ? '' : filter)} className="h-10 rounded bg-gray-200 text-[10px] overflow-hidden" style={{ filter: filter }}>F{i}</button>)}</div>}
                                        </div>
                                    )}
                                    {uploadType === 'webtoon' && <textarea value={inputDesc} onChange={(e) => setInputDesc(e.target.value)} placeholder={t.webtoonDesc} className="w-full h-24 p-4 bg-gray-50 rounded-2xl border-none resize-none" />}
                                    <label className="block w-full h-40 bg-gray-50 rounded-2xl border-2 border-dashed border-gray-200 flex flex-col items-center justify-center cursor-pointer hover:bg-gray-100 relative group">
                                        {previewUrl ? <img src={previewUrl} className="w-full h-full object-cover rounded-2xl" style={{ filter: videoFilter }} /> : <div className="flex flex-col items-center text-gray-400"><ImageIcon className="w-8 h-8 mb-2" /><span className="text-xs font-bold">Upload</span></div>}
                                        <input type="file" accept="image/*" className="hidden" onChange={(e) => handleImageChange(e, setPreviewUrl)} />
                                    </label>
                                </div>
                                <button onClick={handleSubmit} className="w-full py-4 bg-black text-white rounded-2xl font-bold flex items-center justify-center gap-2"><span>{t.upload}</span> <Send size={16} /></button>
                            </div>
                        </div>
                    )}

                    {activePostForComments && (
                        <div className="fixed inset-0 z-[60] bg-black/50 backdrop-blur-sm flex items-end sm:items-center justify-center">
                            <div className="bg-white w-full max-w-sm rounded-t-[32px] sm:rounded-[32px] h-[80vh] flex flex-col shadow-2xl relative">
                                <div className="p-4 border-b border-gray-100 flex justify-between items-center"><h3 className="font-bold text-lg ml-2">Comments</h3><button onClick={() => setActivePostForComments(null)} className="p-2 bg-gray-100 rounded-full"><X size={18} /></button></div>
                                <div className="flex-1 overflow-y-auto p-4 space-y-4">
                                    {(commentsData[activePostForComments] || []).map((comment) => (
                                        <div key={comment.id} className="flex gap-3"><img src={comment.avatar} className="w-8 h-8 rounded-full" /><div><p className="text-xs font-bold">{comment.user}</p><p className="text-sm bg-gray-50 px-3 py-2 rounded-2xl">{comment.text}</p></div></div>
                                    ))}
                                </div>
                                <div className="p-4 border-t border-gray-100"><div className="flex gap-2"><input type="text" value={commentInput} onChange={(e) => setCommentInput(e.target.value)} placeholder={t.commentPlace} className="flex-1 bg-gray-100 border-none rounded-2xl px-4" /><button onClick={handleCommentSubmit} className="w-10 h-10 bg-black text-white rounded-full flex items-center justify-center"><Send size={16} /></button></div></div>
                            </div>
                        </div>
                    )}

                    {/* Bottom Nav */}
                    <div className="fixed bottom-6 left-1/2 -translate-x-1/2 w-[90%] max-w-sm z-50">
                        <nav className="bg-white/80 backdrop-blur-2xl border border-white/50 shadow-[0_20px_50px_rgba(0,0,0,0.1)] rounded-[32px] px-6 py-4 flex justify-between items-center">
                            <button onClick={() => setActiveTab('explore')} className="flex flex-col items-center"><Compass size={24} className={activeTab === 'explore' ? 'text-black' : 'text-gray-300'} /></button>
                            <button onClick={() => setActiveTab('nodes')} className="flex flex-col items-center"><PlayCircle size={24} className={activeTab === 'nodes' ? 'text-black' : 'text-gray-300'} /></button>
                            <div className="relative -top-10"><button onClick={() => setShowCompose(true)} className="w-14 h-14 bg-black text-white rounded-full flex items-center justify-center shadow-2xl hover:rotate-90 transition-transform"><Plus size={32} /></button></div>
                            <button onClick={() => setActiveTab('stories')} className="flex flex-col items-center"><BookOpen size={24} className={activeTab === 'stories' ? 'text-black' : 'text-gray-300'} /></button>
                            <button onClick={() => setActiveTab('profile')} className="flex flex-col items-center"><UserCircle2 size={24} className={activeTab === 'profile' ? 'text-black' : 'text-gray-300'} /></button>
                        </nav>
                    </div>
                </div>
            );
        };

        const root = createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
